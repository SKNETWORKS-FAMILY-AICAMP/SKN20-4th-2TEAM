# RAGAS 평가 결과 비교 (Reranker 적용 전후)

## 1. 논문 검색 결과 비교 (8개)

| 메트릭 | before | after | 변화 |
|--------|--------|-------|------|
| Context Recall | 0.63 | 0.82 | **+0.19 ↑** |
| Context Precision | 0.90 | 0.98 | **+0.08 ↑** |
| Faithfulness | 0.94 | 0.95 | +0.01 |
| Answer Correctness | 0.63 | 0.79 | **+0.16 ↑** |
| 예상 논문 정확도 | 87.5% (7/8) | 100% (8/8) | **+12.5% ↑** |

---

## 2. 메트릭별 의미와 해석

| 메트릭 | 의미 | before → after | 해석 |
|--------|------|----------------|------|
| **Context Recall** | 검색된 문서가 정답에 필요한 정보를 얼마나 포함하는지 | 0.63 → 0.82 | 필요한 정보의 82%를 검색함 (19%p 향상) |
| **Context Precision** | 검색된 문서 중 실제로 관련 있는 비율 | 0.90 → 0.98 | 검색된 문서의 98%가 관련 있음 (노이즈 감소) |
| **Faithfulness** | 답변이 검색된 문서에만 기반하는지 (환각 방지) | 0.94 → 0.95 | 95% 환각 없이 문서 기반 답변 |
| **Answer Correctness** | 답변이 정답(Ground Truth)과 일치하는 정도 | 0.63 → 0.79 | 정답과 79% 일치 (16%p 향상) |
| **예상 논문 정확도** | 질문에서 원하는 논문을 실제로 찾았는지 | 7/8 → 8/8 | 모든 논문을 정확히 찾음 |

---

## 3. 코드 변경 사항

| 변경 | 설명 |
|------|------|
| **Reranker 추가** | 벡터 검색 후 Cross-Encoder로 한번 더 관련성 평가 |
| **k=5 → k=3** | 상위 5개 → 3개로 줄여 노이즈 감소 |
| **Cluster 제거** | 복잡한 클러스터 로직 제거, 파이프라인 단순화 |

---

## 4. Reranker 작동 원리

```
[Before]
질문 → 벡터 검색 → 상위 5개 문서 → 답변 생성
                    (관련 없는 문서 포함 가능)

[After]
질문 → 벡터 검색 → 상위 10개 후보 → Reranker → 상위 3개 → 답변 생성
                                        ↑
                            Query-Document 쌍을
                            직접 평가해서 재정렬
```

### Cross-Encoder vs Bi-Encoder (벡터 검색)

| 방식 | 속도 | 정확도 | 사용 위치 |
|------|------|--------|----------|
| Bi-Encoder (벡터) | 빠름 | 보통 | 1차 검색 (후보 추출) |
| Cross-Encoder | 느림 | 높음 | 2차 재랭킹 (정밀 선택) |

---

## 5. 왜 성능이 향상되었나?

### Before 문제점
- 벡터 유사도만으로 검색 → 키워드는 비슷하지만 관련 없는 문서 포함
- 5개 문서 중 1~2개가 노이즈 → Context Precision 저하
- 노이즈 문서가 답변에 영향 → Answer Correctness 저하

### After 개선점
- Reranker가 Query와 Document를 함께 읽고 관련성 직접 판단
- 진짜 관련 있는 문서 3개만 선택
- 정확한 문서 → 정확한 답변

---

## 6. 핵심 요약

> **"Reranker 하나로 모든 지표가 향상되었습니다"**
>
> - 예상 논문 정확도: 87.5% → **100%**
> - Context Recall: +0.19
> - Answer Correctness: +0.16
>
> Cross-Encoder Reranker가 검색 품질을 크게 개선했습니다.
